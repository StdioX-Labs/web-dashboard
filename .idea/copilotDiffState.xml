<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/SCAN_EVENTS_README.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/SCAN_EVENTS_README.md" />
              <option name="originalContent" value="# Scan Events Feature - Quick Start&#10;&#10;##  What's New&#10;&#10;The Scan Events feature is now **fully mobile-friendly** with advanced capabilities:&#10;&#10;✅ **Smart Barcode Scanner Support** - Auto-detects and uses hardware barcode scanners  &#10;✅ **M-Pesa Message Lookup** - Customers can use group code from payment SMS  &#10;✅ **Individual Ticket Selection** - Choose specific barcodes to redeem from group tickets  &#10;✅ **Payment Status Verification** - Only unpaid tickets prompt for payment  &#10;✅ **Mobile-First Design** - Fully responsive on all devices  &#10;&#10;##  Quick Start&#10;&#10;1. Navigate to **Dashboard → Scan Events**&#10;2. Choose scanning mode:&#10;   - **Camera Scan**: For QR codes and barcodes&#10;   - **Manual Entry**: For typing barcodes or M-Pesa group codes&#10;&#10;##  Documentation&#10;&#10;- **[Complete Guide](./SCAN_EVENTS_GUIDE.md)** - Full documentation with API details&#10;- **[Visual Flow Guide](./VISUAL_FLOW_GUIDE.md)** - Printable staff guide with diagrams&#10;- **[Implementation Summary](./IMPLEMENTATION_SUMMARY.md)** - Technical implementation details&#10;&#10;##  Common Scenarios&#10;&#10;### Scenario 1: Customer has QR Code&#10;1. Select &quot;Camera Scan&quot;&#10;2. Scan the QR code&#10;3. ✅ Ticket validates instantly&#10;4. For group tickets: Select barcodes → Redeem&#10;&#10;### Scenario 2: Customer has M-Pesa Message Only&#10;1. Select &quot;Manual Entry&quot;&#10;2. Enter group code from M-Pesa SMS&#10;3. ✅ Ticket details load&#10;4. Select which tickets to redeem → Redeem&#10;&#10;### Scenario 3: Customer Hasn't Paid&#10;1. Scan or enter barcode&#10;2. ⚠️ System shows &quot;Payment Required&quot;&#10;3. Enter customer's M-Pesa number&#10;4. Customer receives payment prompt on phone&#10;5. ✅ After payment, ticket becomes valid&#10;&#10;##  Technical Stack&#10;&#10;- **Frontend**: Next.js 16, React 19, TypeScript, Tailwind CSS&#10;- **Scanner**: html5-qrcode library&#10;- **Animations**: Framer Motion&#10;- **Notifications**: Sonner (toast)&#10;- **Icons**: Lucide React&#10;&#10;##  Mobile Features&#10;&#10;- Responsive design from 320px to 4K&#10;- Touch-friendly 44x44 touch targets&#10;- Adaptive text sizing&#10;- Scrollable lists with proper overflow&#10;- Optimized spacing and padding&#10;&#10;## ️ API Endpoints&#10;&#10;| Endpoint | Method | Purpose |&#10;|----------|--------|---------|&#10;| `/api/tickets/validate` | POST | Validate ticket by barcode or group code |&#10;| `/api/tickets/redeem` | POST | Redeem selected barcodes from group |&#10;| `/api/payments/mpesa` | POST | Process M-Pesa payment for unpaid tickets |&#10;&#10;##  Features Breakdown&#10;&#10;### Barcode Scanner Hardware Support&#10;- Automatically detects USB/Bluetooth barcode scanners&#10;- Prioritizes hardware scanner over camera&#10;- Supports all standard barcode formats&#10;- Shows confirmation when scanner connected&#10;&#10;### Group Ticket Management&#10;- Visual checkbox interface for barcode selection&#10;- Shows already-scanned tickets (disabled)&#10;- Displays holder names for each barcode&#10;- Prevents over-redemption&#10;- Real-time selection counter&#10;&#10;### Payment Flow&#10;- **Paid tickets** (with QR code): Skip payment entirely&#10;- **Unpaid tickets**: Show M-Pesa payment interface&#10;- Group code tracking for payment records&#10;- Automatic ticket activation after payment&#10;&#10;### M-Pesa Integration&#10;- Customer-only has M-Pesa confirmation SMS? No problem!&#10;- Enter group code directly to lookup ticket&#10;- No barcode needed if customer has payment receipt&#10;- Perfect for customers who didn't receive ticket email&#10;&#10;##  Security Notes&#10;&#10;- All API calls need authentication (implement in production)&#10;- Input validation on both client and server&#10;- Rate limiting recommended for validation endpoint&#10;- Audit logging for all scan attempts&#10;- Payment credentials must be server-side only&#10;&#10;##  Status Indicators&#10;&#10;| Icon | Color | Status | Action |&#10;|------|-------|--------|--------|&#10;| ✅ | Green | Valid | Proceed with redemption |&#10;| ❌ | Red | Invalid | Verify ticket details |&#10;| ⚠️ | Orange | Used | Already scanned |&#10;|  | Yellow | Unpaid | Process payment |&#10;&#10;##  Support&#10;&#10;For issues or questions:&#10;1. Check the [Complete Guide](./SCAN_EVENTS_GUIDE.md)&#10;2. Review the [Visual Flow Guide](./VISUAL_FLOW_GUIDE.md)&#10;3. Check browser console for errors&#10;4. Contact development team&#10;&#10;##  Next Steps&#10;&#10;### For Development&#10;- [ ] Connect to real database&#10;- [ ] Implement M-Pesa STK Push API&#10;- [ ] Add authentication/authorization&#10;- [ ] Set up payment webhooks&#10;- [ ] Add error tracking (Sentry)&#10;- [ ] Implement rate limiting&#10;&#10;### For Testing&#10;- [ ] Test with real barcode scanner&#10;- [ ] Test M-Pesa payment flow&#10;- [ ] Test on various mobile devices&#10;- [ ] Load testing for high traffic&#10;- [ ] Security audit&#10;&#10;---&#10;&#10;**Version**: 2.0.0  &#10;**Status**: ✅ Ready for Integration  &#10;**Last Updated**: January 13, 2026&#10;&#10;" />
              <option name="updatedContent" value="# Scan Events Feature - Quick Start&#10;&#10;##  What's New&#10;&#10;The Scan Events feature is now **fully mobile-friendly** with advanced capabilities:&#10;&#10;✅ **Smart Barcode Scanner Support** - Auto-detects and uses hardware barcode scanners  &#10;✅ **M-Pesa Message Lookup** - Customers can use group code from payment SMS  &#10;✅ **Individual Ticket Selection** - Choose specific barcodes to redeem from group tickets  &#10;✅ **Payment Status Verification** - Only unpaid tickets prompt for payment  &#10;✅ **Mobile-First Design** - Fully responsive on all devices  &#10;&#10;##  Quick Start&#10;&#10;1. Navigate to **Dashboard → Scan Events**&#10;2. Choose scanning mode:&#10;   - **Camera Scan**: For QR codes and barcodes&#10;   - **Manual Entry**: For typing barcodes or M-Pesa group codes&#10;&#10;##  Documentation&#10;&#10;- **[Complete Guide](./SCAN_EVENTS_GUIDE.md)** - Full documentation with API details&#10;- **[Visual Flow Guide](./VISUAL_FLOW_GUIDE.md)** - Printable staff guide with diagrams&#10;- **[Implementation Summary](./IMPLEMENTATION_SUMMARY.md)** - Technical implementation details&#10;&#10;##  Common Scenarios&#10;&#10;### Scenario 1: Customer has QR Code&#10;1. Select &quot;Camera Scan&quot;&#10;2. Scan the QR code&#10;3. ✅ Ticket validates instantly&#10;4. For group tickets: Select barcodes → Redeem&#10;&#10;### Scenario 2: Customer has M-Pesa Message Only&#10;1. Select &quot;Manual Entry&quot;&#10;2. Enter group code from M-Pesa SMS&#10;3. ✅ Ticket details load&#10;4. Select which tickets to redeem → Redeem&#10;&#10;### Scenario 3: Customer Hasn't Paid&#10;1. Scan or enter barcode&#10;2. ⚠️ System shows &quot;Payment Required&quot;&#10;3. Enter customer's M-Pesa number&#10;4. Customer receives payment prompt on phone&#10;5. ✅ After payment, ticket becomes valid&#10;&#10;##  Technical Stack&#10;&#10;- **Frontend**: Next.js 16, React 19, TypeScript, Tailwind CSS&#10;- **Scanner**: html5-qrcode library&#10;- **Animations**: Framer Motion&#10;- **Notifications**: Sonner (toast)&#10;- **Icons**: Lucide React&#10;&#10;##  Mobile Features&#10;&#10;- Responsive design from 320px to 4K&#10;- Touch-friendly 44x44 touch targets&#10;- Adaptive text sizing&#10;- Scrollable lists with proper overflow&#10;- Optimized spacing and padding&#10;&#10;## ️ API Endpoints&#10;&#10;| Endpoint | Method | Purpose |&#10;|----------|--------|---------|&#10;| `/api/tickets/validate` | POST | Validate ticket by barcode or group code |&#10;| `/api/tickets/redeem` | POST | Redeem selected barcodes from group |&#10;| `/api/payments/mpesa` | POST | Process M-Pesa payment for unpaid tickets |&#10;&#10;##  Features Breakdown&#10;&#10;### Barcode Scanner Hardware Support&#10;- Automatically detects USB/Bluetooth barcode scanners&#10;- Prioritizes hardware scanner over camera&#10;- Supports all standard barcode formats&#10;- Shows confirmation when scanner connected&#10;&#10;### Group Ticket Management&#10;- Visual checkbox interface for barcode selection&#10;- Shows already-scanned tickets (disabled)&#10;- Displays holder names for each barcode&#10;- Prevents over-redemption&#10;- Real-time selection counter&#10;&#10;### Payment Flow&#10;- **Paid tickets get QR codes** - Only after payment is confirmed&#10;- **QR code contains**: All ticket info + available barcodes&#10;- **M-Pesa SMS contains**: Only the group code&#10;- **Unpaid bookings**: No QR code, must pay at gate via M-Pesa&#10;- After payment: Group code is generated and sent via SMS&#10;&#10;### M-Pesa Integration &amp; Group Code Lookup&#10;- **Customer paid via M-Pesa?** They receive SMS with group code&#10;- M-Pesa message format: &quot;Payment confirmed. Group Code: GRP123&quot;&#10;- Enter **just the group code** to fetch all ticket details&#10;- System retrieves: Event name, ticket type, all barcodes in group&#10;- Perfect for customers who didn't receive QR code email/link&#10;&#10;##  Security Notes&#10;&#10;- All API calls need authentication (implement in production)&#10;- Input validation on both client and server&#10;- Rate limiting recommended for validation endpoint&#10;- Audit logging for all scan attempts&#10;- Payment credentials must be server-side only&#10;&#10;##  Status Indicators&#10;&#10;| Icon | Color | Status | Action |&#10;|------|-------|--------|--------|&#10;| ✅ | Green | Valid | Proceed with redemption |&#10;| ❌ | Red | Invalid | Verify ticket details |&#10;| ⚠️ | Orange | Used | Already scanned |&#10;|  | Yellow | Unpaid | Process payment |&#10;&#10;##  Support&#10;&#10;For issues or questions:&#10;1. Check the [Complete Guide](./SCAN_EVENTS_GUIDE.md)&#10;2. Review the [Visual Flow Guide](./VISUAL_FLOW_GUIDE.md)&#10;3. Check browser console for errors&#10;4. Contact development team&#10;&#10;##  Next Steps&#10;&#10;### For Development&#10;- [ ] Connect to real database&#10;- [ ] Implement M-Pesa STK Push API&#10;- [ ] Add authentication/authorization&#10;- [ ] Set up payment webhooks&#10;- [ ] Add error tracking (Sentry)&#10;- [ ] Implement rate limiting&#10;&#10;### For Testing&#10;- [ ] Test with real barcode scanner&#10;- [ ] Test M-Pesa payment flow&#10;- [ ] Test on various mobile devices&#10;- [ ] Load testing for high traffic&#10;- [ ] Security audit&#10;&#10;---&#10;&#10;**Version**: 2.0.0  &#10;**Status**: ✅ Ready for Integration  &#10;**Last Updated**: January 13, 2026&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/../../../../../../src/app/api/tickets/lookup/route.ts">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/../../../../../../src/app/api/tickets/lookup/route.ts" />
              <option name="updatedContent" value="import { NextRequest, NextResponse } from 'next/server'&#10;&#10;export async function POST(request: NextRequest) {&#10;  try {&#10;    const { groupCode, barcode } = await request.json()&#10;&#10;    // TODO: Implement actual lookup logic with your database&#10;    // This is a mock implementation&#10;    const mockResult = {&#10;      groupCode,&#10;      tickets: [&#10;        {&#10;          barcode: barcode || 'VT67PD',&#10;          eventName: 'Sample Event 2024',&#10;          status: 'valid'&#10;        }&#10;      ]&#10;    }&#10;&#10;    return NextResponse.json(mockResult)&#10;  } catch (error) {&#10;    return NextResponse.json(&#10;      { error: 'Failed to lookup ticket' },&#10;      { status: 500 }&#10;    )&#10;  }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/../../../../../../src/app/api/tickets/validate/route.ts">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/../../../../../../src/app/api/tickets/validate/route.ts" />
              <option name="updatedContent" value="import { NextRequest, NextResponse } from 'next/server'&#10;&#10;export async function POST(request: NextRequest) {&#10;  try {&#10;    const { barcode, groupCode } = await request.json()&#10;&#10;    // TODO: Implement actual validation logic with your database&#10;    // This is a mock implementation&#10;    const mockTicketInfo = {&#10;      status: 'Valid',&#10;      eventName: 'Sample Event 2024',&#10;      ticketCount: 1,&#10;      barcode,&#10;      groupCode,&#10;      validated: true&#10;    }&#10;&#10;    return NextResponse.json(mockTicketInfo)&#10;  } catch (error) {&#10;    return NextResponse.json(&#10;      { error: 'Failed to validate ticket' },&#10;      { status: 500 }&#10;    )&#10;  }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/../../../../../../src/app/layout.tsx">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/../../../../../../src/app/layout.tsx" />
              <option name="updatedContent" value="// ...existing code...&#10;import { QrCode } from 'lucide-react'&#10;// ...existing code...&#10;          &lt;Link href=&quot;/events&quot; className={linkClass('/events')}&gt;&#10;            &lt;Calendar className=&quot;mr-3 h-5 w-5&quot; /&gt;&#10;            Events&#10;          &lt;/Link&gt;&#10;          &lt;Link href=&quot;/scan&quot; className={linkClass('/scan')}&gt;&#10;            &lt;QrCode className=&quot;mr-3 h-5 w-5&quot; /&gt;&#10;            Scan Events&#10;          &lt;/Link&gt;&#10;          &lt;Link href=&quot;/tickets&quot; className={linkClass('/tickets')}&gt;&#10;// ...existing code...&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/../../../../../../src/app/scan/page.tsx">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/../../../../../../src/app/scan/page.tsx" />
              <option name="updatedContent" value="'use client'&#10;&#10;import { useState } from 'react'&#10;import { Camera, KeyRound, CreditCard } from 'lucide-react'&#10;import QRScanner from '@/components/QRScanner'&#10;import ManualEntry from '@/components/ManualEntry'&#10;import MpesaPayment from '@/components/MpesaPayment'&#10;&#10;export default function ScanPage() {&#10;  const [activeTab, setActiveTab] = useState&lt;'scan' | 'manual' | 'payment'&gt;('scan')&#10;  const [scannedBarcode, setScannedBarcode] = useState&lt;string&gt;('')&#10;  const [groupCode, setGroupCode] = useState&lt;string&gt;('')&#10;&#10;  const handleScanSuccess = (barcode: string) =&gt; {&#10;    setScannedBarcode(barcode)&#10;  }&#10;&#10;  const handleManualSubmit = (code: string) =&gt; {&#10;    setGroupCode(code)&#10;  }&#10;&#10;  return (&#10;    &lt;div className=&quot;p-6&quot;&gt;&#10;      &lt;h1 className=&quot;text-3xl font-bold mb-6&quot;&gt;Scan Events&lt;/h1&gt;&#10;&#10;      {/* Tab Navigation */}&#10;      &lt;div className=&quot;flex gap-2 mb-6 border-b&quot;&gt;&#10;        &lt;button&#10;          onClick={() =&gt; setActiveTab('scan')}&#10;          className={`flex items-center gap-2 px-4 py-2 border-b-2 transition-colors ${&#10;            activeTab === 'scan'&#10;              ? 'border-blue-500 text-blue-600'&#10;              : 'border-transparent text-gray-600 hover:text-gray-900'&#10;          }`}&#10;        &gt;&#10;          &lt;Camera className=&quot;h-5 w-5&quot; /&gt;&#10;          QR Scanner&#10;        &lt;/button&gt;&#10;        &lt;button&#10;          onClick={() =&gt; setActiveTab('manual')}&#10;          className={`flex items-center gap-2 px-4 py-2 border-b-2 transition-colors ${&#10;            activeTab === 'manual'&#10;              ? 'border-blue-500 text-blue-600'&#10;              : 'border-transparent text-gray-600 hover:text-gray-900'&#10;          }`}&#10;        &gt;&#10;          &lt;KeyRound className=&quot;h-5 w-5&quot; /&gt;&#10;          Manual Entry&#10;        &lt;/button&gt;&#10;        &lt;button&#10;          onClick={() =&gt; setActiveTab('payment')}&#10;          className={`flex items-center gap-2 px-4 py-2 border-b-2 transition-colors ${&#10;            activeTab === 'payment'&#10;              ? 'border-blue-500 text-blue-600'&#10;              : 'border-transparent text-gray-600 hover:text-gray-900'&#10;          }`}&#10;        &gt;&#10;          &lt;CreditCard className=&quot;h-5 w-5&quot; /&gt;&#10;          M-Pesa Payment&#10;        &lt;/button&gt;&#10;      &lt;/div&gt;&#10;&#10;      {/* Tab Content */}&#10;      &lt;div className=&quot;mt-6&quot;&gt;&#10;        {activeTab === 'scan' &amp;&amp; (&#10;          &lt;QRScanner onScanSuccess={handleScanSuccess} scannedBarcode={scannedBarcode} /&gt;&#10;        )}&#10;        {activeTab === 'manual' &amp;&amp; (&#10;          &lt;ManualEntry onSubmit={handleManualSubmit} groupCode={groupCode} /&gt;&#10;        )}&#10;        {activeTab === 'payment' &amp;&amp; &lt;MpesaPayment /&gt;}&#10;      &lt;/div&gt;&#10;    &lt;/div&gt;&#10;  )&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/../../../../../../src/components/ManualEntry.tsx">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/../../../../../../src/components/ManualEntry.tsx" />
              <option name="updatedContent" value="'use client'&#10;&#10;import { useState } from 'react'&#10;import { Search, Loader2 } from 'lucide-react'&#10;&#10;interface ManualEntryProps {&#10;  onSubmit: (code: string) =&gt; void&#10;  groupCode: string&#10;}&#10;&#10;export default function ManualEntry({ onSubmit, groupCode }: ManualEntryProps) {&#10;  const [code, setCode] = useState(groupCode)&#10;  const [barcode, setBarcode] = useState('')&#10;  const [loading, setLoading] = useState(false)&#10;  const [result, setResult] = useState&lt;any&gt;(null)&#10;&#10;  const handleSubmit = async (e: React.FormEvent) =&gt; {&#10;    e.preventDefault()&#10;    setLoading(true)&#10;&#10;    try {&#10;      const response = await fetch('/api/tickets/lookup', {&#10;        method: 'POST',&#10;        headers: { 'Content-Type': 'application/json' },&#10;        body: JSON.stringify({ groupCode: code, barcode })&#10;      })&#10;&#10;      const data = await response.json()&#10;      setResult(data)&#10;      onSubmit(code)&#10;    } catch (err) {&#10;      setResult({ error: 'Failed to lookup ticket' })&#10;    } finally {&#10;      setLoading(false)&#10;    }&#10;  }&#10;&#10;  return (&#10;    &lt;div className=&quot;max-w-2xl mx-auto&quot;&gt;&#10;      &lt;div className=&quot;bg-white rounded-lg shadow-md p-6&quot;&gt;&#10;        &lt;h2 className=&quot;text-2xl font-bold mb-4&quot;&gt;Manual Ticket Entry&lt;/h2&gt;&#10;&#10;        &lt;form onSubmit={handleSubmit} className=&quot;space-y-4&quot;&gt;&#10;          &lt;div&gt;&#10;            &lt;label className=&quot;block text-sm font-medium mb-2&quot;&gt;&#10;              Transaction Group Code *&#10;            &lt;/label&gt;&#10;            &lt;input&#10;              type=&quot;text&quot;&#10;              value={code}&#10;              onChange={(e) =&gt; setCode(e.target.value.toUpperCase())}&#10;              placeholder=&quot;TXN123456&quot;&#10;              required&#10;              className=&quot;w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none&quot;&#10;            /&gt;&#10;            &lt;p className=&quot;text-sm text-gray-500 mt-1&quot;&gt;&#10;              Enter the transaction group code to lookup tickets&#10;            &lt;/p&gt;&#10;          &lt;/div&gt;&#10;&#10;          &lt;div&gt;&#10;            &lt;label className=&quot;block text-sm font-medium mb-2&quot;&gt;&#10;              Barcode (Optional)&#10;            &lt;/label&gt;&#10;            &lt;input&#10;              type=&quot;text&quot;&#10;              value={barcode}&#10;              onChange={(e) =&gt; setBarcode(e.target.value.toUpperCase())}&#10;              placeholder=&quot;VT67PD&quot;&#10;              className=&quot;w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none&quot;&#10;            /&gt;&#10;            &lt;p className=&quot;text-sm text-gray-500 mt-1&quot;&gt;&#10;              Optionally enter a specific barcode to verify&#10;            &lt;/p&gt;&#10;          &lt;/div&gt;&#10;&#10;          &lt;button&#10;            type=&quot;submit&quot;&#10;            disabled={!code || loading}&#10;            className=&quot;w-full bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2&quot;&#10;          &gt;&#10;            {loading ? (&#10;              &lt;&gt;&#10;                &lt;Loader2 className=&quot;h-5 w-5 animate-spin&quot; /&gt;&#10;                Looking up...&#10;              &lt;/&gt;&#10;            ) : (&#10;              &lt;&gt;&#10;                &lt;Search className=&quot;h-5 w-5&quot; /&gt;&#10;                Lookup Ticket&#10;              &lt;/&gt;&#10;            )}&#10;          &lt;/button&gt;&#10;        &lt;/form&gt;&#10;&#10;        {result &amp;&amp; (&#10;          &lt;div className={`mt-6 p-4 rounded-lg ${result.error ? 'bg-red-50 border border-red-200' : 'bg-green-50 border border-green-200'}`}&gt;&#10;            {result.error ? (&#10;              &lt;p className=&quot;text-red-700&quot;&gt;{result.error}&lt;/p&gt;&#10;            ) : (&#10;              &lt;div className=&quot;space-y-2&quot;&gt;&#10;                &lt;h3 className=&quot;font-bold text-lg&quot;&gt;Ticket Found&lt;/h3&gt;&#10;                &lt;p&gt;&lt;span className=&quot;font-semibold&quot;&gt;Group Code:&lt;/span&gt; {result.groupCode}&lt;/p&gt;&#10;                &lt;p&gt;&lt;span className=&quot;font-semibold&quot;&gt;Tickets:&lt;/span&gt; {result.tickets?.length || 0}&lt;/p&gt;&#10;                {result.tickets?.map((ticket: any, idx: number) =&gt; (&#10;                  &lt;div key={idx} className=&quot;pl-4 border-l-2 border-green-300&quot;&gt;&#10;                    &lt;p className=&quot;font-semibold&quot;&gt;{ticket.barcode}&lt;/p&gt;&#10;                    &lt;p className=&quot;text-sm&quot;&gt;{ticket.eventName}&lt;/p&gt;&#10;                  &lt;/div&gt;&#10;                ))}&#10;              &lt;/div&gt;&#10;            )}&#10;          &lt;/div&gt;&#10;        )}&#10;      &lt;/div&gt;&#10;    &lt;/div&gt;&#10;  )&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/../../../../../../src/components/QRScanner.tsx">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/../../../../../../src/components/QRScanner.tsx" />
              <option name="updatedContent" value="'use client'&#10;&#10;import { useState, useEffect, useRef } from 'react'&#10;import { Camera, Check, X, Loader2 } from 'lucide-react'&#10;&#10;interface QRScannerProps {&#10;  onScanSuccess: (barcode: string) =&gt; void&#10;  scannedBarcode: string&#10;}&#10;&#10;export default function QRScanner({ onScanSuccess, scannedBarcode }: QRScannerProps) {&#10;  const [isScanning, setIsScanning] = useState(false)&#10;  const [groupCode, setGroupCode] = useState('')&#10;  const [ticketInfo, setTicketInfo] = useState&lt;any&gt;(null)&#10;  const [loading, setLoading] = useState(false)&#10;  const [error, setError] = useState('')&#10;  const videoRef = useRef&lt;HTMLVideoElement&gt;(null)&#10;  const streamRef = useRef&lt;MediaStream | null&gt;(null)&#10;&#10;  const startCamera = async () =&gt; {&#10;    try {&#10;      const stream = await navigator.mediaDevices.getUserMedia({&#10;        video: { facingMode: 'environment' }&#10;      })&#10;      if (videoRef.current) {&#10;        videoRef.current.srcObject = stream&#10;        streamRef.current = stream&#10;        setIsScanning(true)&#10;      }&#10;    } catch (err) {&#10;      setError('Failed to access camera. Please grant camera permissions.')&#10;    }&#10;  }&#10;&#10;  const stopCamera = () =&gt; {&#10;    if (streamRef.current) {&#10;      streamRef.current.getTracks().forEach(track =&gt; track.stop())&#10;      streamRef.current = null&#10;    }&#10;    setIsScanning(false)&#10;  }&#10;&#10;  const validateTicket = async () =&gt; {&#10;    if (!scannedBarcode || !groupCode) {&#10;      setError('Please scan a barcode and enter a group code')&#10;      return&#10;    }&#10;&#10;    setLoading(true)&#10;    setError('')&#10;&#10;    try {&#10;      const response = await fetch('/api/tickets/validate', {&#10;        method: 'POST',&#10;        headers: { 'Content-Type': 'application/json' },&#10;        body: JSON.stringify({ barcode: scannedBarcode, groupCode })&#10;      })&#10;&#10;      if (!response.ok) throw new Error('Validation failed')&#10;&#10;      const data = await response.json()&#10;      setTicketInfo(data)&#10;    } catch (err) {&#10;      setError('Failed to validate ticket. Please try again.')&#10;    } finally {&#10;      setLoading(false)&#10;    }&#10;  }&#10;&#10;  useEffect(() =&gt; {&#10;    return () =&gt; stopCamera()&#10;  }, [])&#10;&#10;  return (&#10;    &lt;div className=&quot;max-w-2xl mx-auto&quot;&gt;&#10;      &lt;div className=&quot;bg-white rounded-lg shadow-md p-6&quot;&gt;&#10;        &lt;h2 className=&quot;text-2xl font-bold mb-4&quot;&gt;QR Code Scanner&lt;/h2&gt;&#10;&#10;        {/* Camera View */}&#10;        &lt;div className=&quot;mb-6&quot;&gt;&#10;          {isScanning ? (&#10;            &lt;div className=&quot;relative&quot;&gt;&#10;              &lt;video&#10;                ref={videoRef}&#10;                autoPlay&#10;                playsInline&#10;                className=&quot;w-full rounded-lg&quot;&#10;              /&gt;&#10;              &lt;button&#10;                onClick={stopCamera}&#10;                className=&quot;absolute top-4 right-4 bg-red-500 text-white p-2 rounded-full hover:bg-red-600&quot;&#10;              &gt;&#10;                &lt;X className=&quot;h-5 w-5&quot; /&gt;&#10;              &lt;/button&gt;&#10;            &lt;/div&gt;&#10;          ) : (&#10;            &lt;button&#10;              onClick={startCamera}&#10;              className=&quot;w-full py-12 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-500 transition-colors flex flex-col items-center gap-2&quot;&#10;            &gt;&#10;              &lt;Camera className=&quot;h-12 w-12 text-gray-400&quot; /&gt;&#10;              &lt;span className=&quot;text-gray-600&quot;&gt;Click to start camera&lt;/span&gt;&#10;            &lt;/button&gt;&#10;          )}&#10;        &lt;/div&gt;&#10;&#10;        {/* Scanned Barcode Display */}&#10;        {scannedBarcode &amp;&amp; (&#10;          &lt;div className=&quot;mb-4 p-4 bg-green-50 border border-green-200 rounded-lg&quot;&gt;&#10;            &lt;div className=&quot;flex items-center gap-2&quot;&gt;&#10;              &lt;Check className=&quot;h-5 w-5 text-green-600&quot; /&gt;&#10;              &lt;span className=&quot;font-semibold&quot;&gt;Scanned Barcode:&lt;/span&gt;&#10;              &lt;code className=&quot;text-lg&quot;&gt;{scannedBarcode}&lt;/code&gt;&#10;            &lt;/div&gt;&#10;          &lt;/div&gt;&#10;        )}&#10;&#10;        {/* Group Code Input */}&#10;        &lt;div className=&quot;mb-4&quot;&gt;&#10;          &lt;label className=&quot;block text-sm font-medium mb-2&quot;&gt;&#10;            Enter Transaction Group Code&#10;          &lt;/label&gt;&#10;          &lt;input&#10;            type=&quot;text&quot;&#10;            value={groupCode}&#10;            onChange={(e) =&gt; setGroupCode(e.target.value.toUpperCase())}&#10;            placeholder=&quot;e.g., TXN123456&quot;&#10;            className=&quot;w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none&quot;&#10;          /&gt;&#10;          &lt;p className=&quot;text-sm text-gray-500 mt-1&quot;&gt;&#10;            Group code may contain one or multiple tickets&#10;          &lt;/p&gt;&#10;        &lt;/div&gt;&#10;&#10;        {/* Validate Button */}&#10;        &lt;button&#10;          onClick={validateTicket}&#10;          disabled={!scannedBarcode || !groupCode || loading}&#10;          className=&quot;w-full bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2&quot;&#10;        &gt;&#10;          {loading ? (&#10;            &lt;&gt;&#10;              &lt;Loader2 className=&quot;h-5 w-5 animate-spin&quot; /&gt;&#10;              Validating...&#10;            &lt;/&gt;&#10;          ) : (&#10;            'Validate Ticket'&#10;          )}&#10;        &lt;/button&gt;&#10;&#10;        {/* Error Message */}&#10;        {error &amp;&amp; (&#10;          &lt;div className=&quot;mt-4 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700&quot;&gt;&#10;            {error}&#10;          &lt;/div&gt;&#10;        )}&#10;&#10;        {/* Ticket Info */}&#10;        {ticketInfo &amp;&amp; (&#10;          &lt;div className=&quot;mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg&quot;&gt;&#10;            &lt;h3 className=&quot;font-bold text-lg mb-2&quot;&gt;Ticket Information&lt;/h3&gt;&#10;            &lt;div className=&quot;space-y-2&quot;&gt;&#10;              &lt;p&gt;&lt;span className=&quot;font-semibold&quot;&gt;Status:&lt;/span&gt; {ticketInfo.status}&lt;/p&gt;&#10;              &lt;p&gt;&lt;span className=&quot;font-semibold&quot;&gt;Event:&lt;/span&gt; {ticketInfo.eventName}&lt;/p&gt;&#10;              &lt;p&gt;&lt;span className=&quot;font-semibold&quot;&gt;Tickets:&lt;/span&gt; {ticketInfo.ticketCount}&lt;/p&gt;&#10;            &lt;/div&gt;&#10;          &lt;/div&gt;&#10;        )}&#10;      &lt;/div&gt;&#10;    &lt;/div&gt;&#10;  )&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>